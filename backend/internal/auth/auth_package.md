# Пакет `auth`

Библиотека `auth` отвечает за регистрацию и аутентификацию пользователей, генерацию JWT‑токенов, а также предоставляет HTTP‑маршруты и бизнес‑логику для работы с ними в приложении CollabBoard.

---

## Функции сервиса

### `NewService`

| **Имя**      | **Параметры**                    | **Описание**                                                                             | **Возвращает** |
| ------------ | -------------------------------- | ---------------------------------------------------------------------------------------- | -------------- |
| `NewService` | `q *db.Queries`, `secret string` | Создаёт экземпляр сервиса аутентификации, инкапсулируя доступ к БД и секрет подписи JWT. | `*Service`     |

#### Пример

```go
svc := auth.NewService(queries, os.Getenv("JWT_SECRET"))
```

### `(*Service).Register`

| **Имя**    | **Параметры**                                                           | **Описание**                                                                                                                 | **Возвращает**                                    |
| ---------- | ----------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| `Register` | `ctx context.Context`, `name string`, `email string`, `password string` | Регистрирует нового пользователя: проверяет уникальность email, хеширует пароль, создаёт запись в БД и генерирует JWT‑токен. | `(token string, user auth.UserPublic, err error)` |

#### Пример

```go
token, user, err := svc.Register(ctx, "Alice", "alice@example.com", "pa55w0rd")
```

### `(*Service).Login`

| **Имя** | **Параметры**                                            | **Описание**                                                                                                                          | **Возвращает**                                    |
| ------- | -------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| `Login` | `ctx context.Context`, `email string`, `password string` | Проверяет учётные данные пользователя; при успехе возвращает новый JWT и публичные данные. В случае ошибки — `ErrInvalidCredentials`. | `(token string, user auth.UserPublic, err error)` |

#### Пример

```go
token, user, err := svc.Login(ctx, "alice@example.com", "pa55w0rd")
```

### `(*Service).GetUserByID`

| **Имя**       | **Параметры**                     | **Описание**                                          | **Возвращает**                      |
| ------------- | --------------------------------- | ----------------------------------------------------- | ----------------------------------- |
| `GetUserByID` | `ctx context.Context`, `id int32` | Получает публичные данные пользователя по ID из базы. | `(user auth.UserPublic, err error)` |

#### Пример

```go
usr, err := svc.GetUserByID(ctx, 1)
```

---

## Функции HTTP‑роутинга

### `RegisterRoutes`

| **Имя**          | **Параметры**                                            | **Описание**                                                                                                | **Возвращает** |
| ---------------- | -------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | -------------- |
| `RegisterRoutes` | `r *gin.Engine`, `svc *auth.Service`, `jwtSecret string` | Регистрирует маршруты `/auth/register`, `/auth/login`, `/auth/me`, привязывая обработчики и JWT‑middleware. | —              |

#### Пример

```go
auth.RegisterRoutes(router, svc, os.Getenv("JWT_SECRET"))
```
